import{a as e,j as i,F as w}from"./emotion-react-jsx-runtime.browser.esm-811f184c.js";import{A as N,P}from"./AuthenticatedLayout-0eac8c2c.js";import{r as g,q as R,a as B,c as D}from"./app-8ce9871c.js";import{d as v,c as o}from"./DefaultThemeProvider-6dfc8fb6.js";import{e as p}from"./emotionCss-985c7b5f.js";import{d as I}from"./dayjs.min-b3c947a2.js";import{C as M}from"./Container-df69f2e3.js";import{T as y,F as S,I as Y,S as _,a as A}from"./TextField-a66b38a6.js";import{L as G}from"./LoadingButton-beb28c78.js";import{d as E,T as H,a as C,b as n,c as Q,e as z}from"./TableRow-a0848bce.js";import{M as J}from"./MenuItem-89d2835e.js";import{R as K,a as T,F}from"./RadioGroup-760ceb0a.js";import"./ApplicationLogo-50c12759.js";import"./transition-c1cd425d.js";import"./ButtonBase-af38a31a.js";import"./styled-9ed81807.js";import"./useControlled-a457b507.js";import"./Button-05d71853.js";import"./Typography-4bc893b3.js";function ge({auth:d,items:c,order:l}){const r=v().palette,u=v().breakpoints.values,[h,m]=g.useState(!1),t=R().props.errors,[s,a]=g.useState({status:l.status,items:c}),[q,L]=g.useState(l.total),b=o`
        display: block;
        margin: 16px auto;
    `,$=({name:f,value:k})=>{a(j=>({...j,[f]:k}))},x=f=>{m(!0),D.put(route("purchases.update",{id:l.id}),s,{finish:()=>{m(!1)}})};return e(w,{children:i(N,{user:d.user,header:e("h2",{className:"font-semibold text-xl leading-tight",children:"購買履歴 編集画面"}),children:[e(B,{title:"購買履歴 編集画面"}),e("div",{className:"py-12",children:e("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e("div",{className:"overflow-hidden shadow-sm sm:rounded-lg",css:o`background:${r.bg.color1};`,children:e("div",{className:"p-6",children:i(M,{css:o`width:${u.sm}px;`,children:[e(y,{label:"購入日",type:"date",variant:"outlined",css:p(r).textFieldDisabled,inputProps:{disabled:!0},name:"date",value:I(l.created_at).format("YYYY-MM-DD")}),e(y,{label:"会員名",variant:"outlined",css:p(r).textFieldDisabled,inputProps:{disabled:!0},name:"customer_info",value:l.customer_name}),e(O,{items:c,textFieldCss:p(r).textField,buttonCss:b,palette:r,formData:s,setFormData:a,total:q,setTotal:L,handleSubmit:x}),t.items&&e("div",{css:o`color:${r.error.main};`,children:t.items}),t["items.0.id"]&&e("div",{css:o`color:${r.error.main};`,children:t["items.0.id"]}),t["items.0.quantity"]&&e("div",{css:o`color:${r.error.main};`,children:t["items.0.quantity"]}),e(U,{palette:r,formData:s,handleChange:$}),t.status&&e("div",{css:o`color:${r.error.main};`,children:t.status}),e(G,{loading:h,variant:"contained",css:b,color:"primary",onClick:x,children:"更新する"})]})})})})})]})})}function O({palette:d,formData:c,setFormData:l,total:r,setTotal:u}){const h=({index:t,quantity:s})=>{const a=c.items;a[t].quantity=s,l({...c,items:a}),m(a)},m=t=>{let s=0;t.map(a=>{s+=a.price*a.quantity}),u(s)};return i(w,{children:[e(z,{component:P,css:o`
            margin: 48px 0 16px 0;
        `,children:i(E,{children:[e(H,{children:i(C,{children:[e(n,{children:"id"}),e(n,{children:"商品名"}),e(n,{align:"right",children:"金額"}),e(n,{align:"right",children:"数量"}),e(n,{align:"right",children:"小計"})]})}),e(Q,{children:c.items.map((t,s)=>i(C,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e(n,{component:"th",scope:"row",children:t.id}),e(n,{children:t.name}),i(n,{align:"right",children:[t.price.toLocaleString()," 円"]}),e(n,{align:"right",children:i(S,{children:[e(Y,{}),e(_,{id:t.id+"",value:t.quantity,label:"",onChange:a=>h({index:s,quantity:a.target.value}),children:[0,1,2,3,4,5,6,7,8,9].map(a=>i(J,{value:a,children:[a," 個"]},a))})]})}),i(n,{align:"right",css:o`min-width:120px;`,children:[(t.price*t.quantity).toLocaleString()," 円"]})]},s))})]})}),i("div",{css:o`
            margin-bottom: 24px;
            text-align: center;
            background: ${d.bg.color2};
            padding: 8px;
            border-radius: 3px;
            border-bottom: 2px ${d.bg.color3} solid;
        `,children:["合計　",(r-0).toLocaleString()," 円"]})]})}function U({palette:d,formData:c,handleChange:l}){return i(S,{css:p(d).formControl,children:[e(A,{id:"demo-row-radio-buttons-group-label",children:"ステータス"}),i(K,{css:o`
            display:flex;
            align-items: center;
            justify-content: space-evenly;
        `,row:!0,"aria-labelledby":"demo-row-radio-buttons-group-label",name:"status",value:c.status,onChange:r=>l(r.target),children:[e(F,{value:1,control:e(T,{}),label:"未キャンセル"}),e(F,{value:0,control:e(T,{}),label:"キャンセルする"})]})]})}export{ge as default};
